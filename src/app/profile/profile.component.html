<app-menu *ngIf="auth.loggedIn()"></app-menu>
<div class="profile_container">
	<div class="pop_up_container gallery" id="profile-gallery" *ngIf="photos[selectedAlbum].array?.length > 0">
		<div class="pop_up_back" onclick="showPopup(false, '#profile-gallery')"></div>
		<div class="pop_up">
			<div class="inner border_radius">
				<div class="bg_primary">
					<div class="pop_up_title font_white">
						<h1 class="title" *ngIf="selectedAlbum == 0">
							Fotos de Portada
						</h1>
						<h1 class="title" *ngIf="selectedAlbum == 1">
							Fotos de Perfil
						</h1>
						<div class="close_button">
							<button class="pd_8 hover_black circle" onclick="showPopup(false, '#profile-gallery')">
								<img class="icon" src="assets/icons/arrow-left_white.png">
							</button>
						</div>
					</div>
				</div>
				<div class="gallery_container">
					<div class="gal_inner bg_black relative_pos">
						<div class="img_container ">
							<img src="{{ photos[selectedAlbum].array[photos[selectedAlbum].selected] }}">
						</div>
						<div class="tr_0 h_32" *ngIf="privateUser">
							<div class="increment_margin size_32 relative_pos">
								<button class="options_button hover_black size_32 text_align_center circle">
									<img class="icon v_align_middle" src="assets/icons/dots-vertical_white.png">
								</button>
								<div class="hidden_options">
									<div class="bg_white pd_bottom_8 pd_top_8 shadow_flat border_radius font_normal">
										<p class="pd_8 pd_left_16 pd_right_16 hover_black" (click)="changePhoto()" *ngIf="selectedAlbum == 0 && photos[selectedAlbum].array[photos[selectedAlbum].selected] !== userSrc + 'background/' + user.backPhoto">
											<span>Seleccionar como foto de portada</span>
										</p>
										<p class="pd_8 pd_left_16 pd_right_16 hover_black" (click)="changePhoto()" *ngIf="selectedAlbum == 1 && photos[selectedAlbum].array[photos[selectedAlbum].selected] !== userSrc + 'profile/' + user.profilePhoto">
											<span>Seleccionar como foto de Perfil</span>
										</p>
										<p class="pd_8 pd_left_16 pd_right_16 hover_black" (click)="deletePhoto()">
											Eliminar Foto
										</p>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="buttons_container bg_white static_col">
						<button id="prof-galbutton-left" class="col_3 left hover_black" (click)="passImg(false, photos[selectedAlbum].album)">
							<img class="icon opacity v_align_middle" src="assets/icons/arrow-left_black.png"><span class="mr_left_16 opacity font_bold v_align_middle">Atras</span>
						</button><div class="col_3 v_align_middle text_align_center font_big opacity">
							<b>{{ photos[selectedAlbum].selected + 1 }}</b> de <b>{{ photos[selectedAlbum].array.length }}</b>
						</div><button id="prof-galbutton-right" class="col_3 right hover_black" (click)="passImg(true, photos[selectedAlbum].album)">
							<span class="mr_right_16 opacity font_bold v_align_middle">Siguiente</span><img class="icon opacity v_align_middle" src="assets/icons/arrow-right_black.png">
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="pop_up_container" id="user-editphotos" *ngIf="privateUser">
		<div class="pop_up_back" onclick="showPopup(false, '#user-editphotos')"></div>
		<div class="pop_up">
			<div class="inner border_radius">
				<div class="bg_primary">
					<div class="pop_up_title font_white">
						<h1 class="title">
							Actualizar Fotos
						</h1>
						<div class="close_button">
							<button class="pd_8 hover_black circle" onclick="showPopup(false, '#user-editphotos')">
								<img class="icon" src="assets/icons/arrow-left_white.png">
							</button>
						</div>
					</div>
				</div>
				<div class="update_photos_container">
					<div class="profile_display small">
						<div class="background bg_primary_dark">
							<div class="editable">
								<span class="size_48 circle hover_black text_align_center" onclick="triggerClick('#back-img-file')">
									<img class="icon mr_top_12" src="assets/icons/camera_white.png">
								</span>
							</div>
							<div class="img_container bg_primary_dark">
								<img src="/media/{{ user._id }}/background/{{ user.backPhoto }}" id="profile-back" *ngIf="user.backPhoto != undefined && user.profilePhoto != ''" adjustable>
							</div>
						</div>
						<div class="profile_photo font_white">
							<div class="inner">
								<div class="img_container circle shadow_flat">
									<img src="assets/icons/default_profile.png" *ngIf="user.profilePhoto == undefined || user.profilePhoto == ''" id="profile-photo">
									<img src="/media/{{ user._id }}/profile/{{ user.profilePhoto }}" *ngIf="user.profilePhoto != undefined && user.profilePhoto != ''" id="profile-photo">
									<div class="editable" onclick="triggerClick('#profile-img-file')">
										<img src="assets/icons/camera_white.png">
									</div>
								</div>
							</div>
						</div>
					</div>
					<form id="formUpload" class="field pd_16 text_align_right" action="api/profile/" method="POST" enctype="multipart/form-data">
						<div class="hidden_input">
							<input type="file" accept="image/*" name="profilePhoto" id="profile-img-file" onchange="previewPhoto(this, '#profile-photo')">
							<input type="file" accept="image/*" name="profileBackground" id="back-img-file" onchange="previewPhoto(this, '#profile-back');resizeImg('#profile-back');">
						</div>
						<input type="submit" class="bg_secondary shadow_raised border_radius font_white" name="" value="Actualizar" onclick="$('#formUpload').submit();">
					</form>
				</div>
			</div>
		</div>
	</div>
	<article class="mr_bottom_24">
		<section class="bg_white shadow_flat border_radius mr_bottom_12 relative_pos">
			<div class="tr_0 h_32" *ngIf="privateUser">
				<div class="increment_margin size_32 relative_pos">
					<button class="options_button hover_black size_32 text_align_center circle">
						<img class="icon v_align_middle" src="assets/icons/dots-vertical_white.png">
					</button>
					<div class="hidden_options">
						<div class="bg_white pd_bottom_8 pd_top_8 shadow_flat border_radius font_normal">
							<p class="pd_8 pd_left_16 pd_right_16 hover_black" onclick="showPopup(true, '#profile-gallery')" (click)="selectedAlbum = 0">
								Ver foto de portada
							</p>
							<p class="pd_8 pd_left_16 pd_right_16 hover_black" onclick="showPopup(true, '#user-editphotos')">
								Subir fotos
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="profile_display">
				<div class="background bg_primary_dark">
					<div class="img_container" *ngIf="user.backPhoto != undefined && user.backPhoto != ''">
						<img src="/media/{{ user._id }}/background/{{ user.backPhoto }}" adjustable>
					</div>
					<div class="bg_opacity" *ngIf="user.backPhoto != undefined && user.backPhoto != ''"></div>
				</div>
				<div class="profile_photo font_white">
					<div class="inner">
						<div class="img_container circle shadow_flat cursor_pointer" onclick="showPopup(true, '#profile-gallery')" (click)="selectedAlbum = 1">
							<img src="assets/icons/default_profile.png" *ngIf="user.profilePhoto == undefined || user.profilePhoto == ''">
							<img src="/media/{{ user._id }}/profile/{{ user.profilePhoto }}"*ngIf="user.profilePhoto != undefined && user.profilePhoto != ''">
						</div><div class="info">
							<h3 class="title_smaller">
								{{ user.name }} {{ user.lastName }}
							</h3>
							<p class="opacity mr_top_8">
								<b class="font_big font_normal">{{ user.mail }}</b>
							</p>
						</div>
					</div>
				</div>
			</div>
			<div class="static_col text_align_center">
				<div class="col_3">
					<div class="pd_12">
						<h4 class="font_normal opacity">Tipo</h4>
						<h2 class="font_normal font_big mr_top_4">{{ userTypes[user.privilege] }}</h2>
					</div>
				</div><div class="col_3">
					<div class="pd_12">
						<h4 class="font_normal opacity">Cursos</h4>
						<h2 class="font_normal font_big mr_top_4" *ngIf="user.courses?.length > 0">{{ user.courses?.length }}</h2>
						<h2 class="font_normal font_big mr_top_4" *ngIf="user.courses?.length < 1 || user.courses == undefined">0</h2>
					</div>
				</div><div class="col_3">
					<div class="pd_12">
						<h4 class="font_normal opacity">Promedio</h4>
						<h2 class="font_normal font_big mr_top_4">0.0</h2>
					</div>
				</div>
			</div>
		</section>
		<section>
			<div class="pd_16 resp_title">
				<h2 class="title_small font_secondary">
					Información
				</h2>
			</div>
			<div class="bg_white shadow_flat mr_bottom_8">
				<div class="pd_16">
					<div class="mr_bottom_12">
						<p class="opacity font_bold mr_bottom_4">Teléfono</p>
						<p class="font_big">
							<img class="icon opacity v_align_middle mr_8" src="assets/icons/phone_black.png">
							<span class=" v_align_middle mr_left_8">
								{{ user.phone }}
							</span>
						</p>
					</div>
					<div>
						<p class="opacity font_bold mr_bottom_4">Dirección</p>
						<p class="font_big">
							<img class="icon opacity v_align_middle mr_8" src="assets/icons/map-marker_black.png">
							<span class="v_align_middle mr_left_8 opacity">
								<b>Sin dirección</b>
							</span>
						</p>
					</div>
				</div>
			</div>
		</section>
		<section *ngIf="user.privilege != 0">
			<div class="pd_16 resp_title">
				<h2 class="title_small font_secondary">
					Cursos
				</h2>
			</div>
			<div class="pd_32 text_align_center" *ngIf="user.courses?.length < 1">
				<h2 class="title_big font_light opacity" *ngIf="!privateUser">
					Este usuario no esta inscrito a ningun curso por el momento
				</h2>
				<div *ngIf="privateUser">
					<h2 class="title_big font_light opacity">
						No estas inscrito a ningun curso por el momento
					</h2>
					<div class="field mr_top_24">
						<a href="/asignaturas" class="font_white">
							<button class="pd_12 bg_secondary shadow_raised border_radius font_white">
								Agregar Curso(s)
							</button>
						</a>
					</div>
				</div>
			</div>
			<div class="bg_white shadow_flat border_radius mr_bottom_12" *ngFor="let course of user.courses">
				<div class="list_element">
					<div class="ref">
						<span class="circle" [ngStyle]="getRandomColor()">
							<label class="title_smaller font_light font_white size_24">{{ (course.name).charAt(0) }}</label>
						</span>
					</div><div class="info">
						<button class="options_button hover_lightgray size_32 text_align_center circle">
							<img class="icon v_align_middle opacity" src="assets/icons/dots-vertical_black.png">
						</button>
						<div class="hidden_options">
							<div class="bg_white pd_bottom_8 pd_top_8 shadow_flat border_radius font_normal">
								<a>
									<p class="pd_8 pd_left_16 pd_right_16 hover_black font_red">
										Eliminar
									</p>
								</a>
							</div>
						</div>
						<div class="pd_12 pd_left_16 pd_right_16">
							<div class="mr_bottom_8">
								<h3 class="font_normal mr_bottom_4">
									{{ course.subject.name }}
								</h3>
								<p class="opacity">
									<b>{{ course.group.name }}</b>
								</p>
								<div class="mr_top_8">
									<p class="opacity">
										Nivel Asignatura: <b>{{ course.subject.level }}</b>
									</p>
									<p class="opacity">
										Nivel Grupo: <b>{{ course.group.level }}</b>
									</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
	</article>
</div>


